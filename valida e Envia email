

public bool PreparaEmail(string Assunto, string CorpoEmail)
     {
         EmailModel email = new EmailModel();
         try
         {
             string[] emails = email.EmalDestino.Split(';');
             foreach (string Destino in emails)
             {
                 if (this.ValidaEnderecoEmail(Destino))
                 {
                     DisparaEmail(Assunto, CorpoEmail, Destino);
                     Thread.Sleep(5000);
                 }
             }
             return true;
         }
         catch
         {
             throw;
         }
     }


          public bool ValidaEnderecoEmail(string enderecoEmail)
                 {
                     try
                     {
                         //define a expressão regulara para validar o email
                         string texto_Validar = enderecoEmail;
                         Regex expressaoRegex = new Regex(@"\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}");
                         // testa o email com a expressão
                         if (expressaoRegex.IsMatch(texto_Validar))
                         {
                             return true;
                         }
                         else
                         {
                             return false;
                         }
                     }
                     catch
                     {
                         throw;
                     }
                 }
